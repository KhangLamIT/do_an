Create database QL_NhaSach

Create table NHANVIEN(
MANV nvarchar(10) Primary key,
TENNV nvarchar(255),
DC nvarchar(255),
EMAIL nvarchar(255),
SDT nvarchar(255),
NGAYSINH date,
disabled int DEFAULT '0',
MATKHAU nvarchar(255)
) 

Create table MATHANG (
MAMH nchar(10) primary key,
TENMATHANG NVARCHAR(500),
disabled int DEFAULT '0',
NGUOITAO nvarchar(10),
NGAYTAO Date DEFAULT getdate(),
NGUOISUA nvarchar(10),
NGAYSUA Date DEFAULT getdate(),
CONSTRAINT fk_MH_KHNGT
  FOREIGN KEY (NGUOITAO)
  REFERENCES NHANVIEN(MANV),
  CONSTRAINT fk_MH_KHNGS
  FOREIGN KEY (NGUOISUA)
  REFERENCES NHANVIEN(MANV)
)

Create table LOAIMATHANG (
MALOAI nchar(10) primary key,
TENLOAI NVARCHAR(500),
HINHMINHHOA NVARCHAR(255),
MAMH nchar (10),
disabled int DEFAULT '0',
CONSTRAINT fk_MH_LMH
  FOREIGN KEY (MAMH)
  REFERENCES MATHANG(MAMH ),
NGUOITAO nvarchar(10),
NGAYTAO Date DEFAULT getdate(),
NGUOISUA nvarchar(10),
NGAYSUA Date DEFAULT getdate(),
CONSTRAINT fk_LOAIMATHANG_KHNGT
  FOREIGN KEY (NGUOITAO)
  REFERENCES NHANVIEN(MANV),
  CONSTRAINT fk_LOAIMATHANG_KHNGS
  FOREIGN KEY (NGUOISUA)
  REFERENCES NHANVIEN(MANV)
)
Create table CHUDE (
MACD nchar(10) primary key,
TENCD NVARCHAR(500),
HINHMINHHOA NVARCHAR(255),
MALOAI nchar (10),
disabled int DEFAULT '0',
CONSTRAINT fk_CD_LMH
  FOREIGN KEY (MALOAI )
  REFERENCES LOAIMATHANG (MALOAI ),
  NGUOITAO nvarchar(10),
NGAYTAO Date DEFAULT getdate(),
NGUOISUA nvarchar(10),
NGAYSUA Date DEFAULT getdate(),
CONSTRAINT fk_CD_KHNGT
  FOREIGN KEY (NGUOITAO)
  REFERENCES NHANVIEN(MANV),
  CONSTRAINT fk_CD_KHNGS
  FOREIGN KEY (NGUOISUA)
  REFERENCES NHANVIEN(MANV)
)

Create table LOAICHUDE (
MALOAICD nchar(10) primary key,
TENLOAICD NVARCHAR(500),
HINHMINHHOA NVARCHAR(255),
MACD nchar (10),
disabled int DEFAULT '0',
CONSTRAINT fk_LOAICD_CD
  FOREIGN KEY (MACD )
  REFERENCES CHUDE (MACD ),
NGUOITAO nvarchar(10),
NGAYTAO Date DEFAULT getdate(),
NGUOISUA nvarchar(10),
NGAYSUA Date DEFAULT getdate(),
CONSTRAINT fk_LOAICD_KHNGT
  FOREIGN KEY (NGUOITAO)
  REFERENCES NHANVIEN(MANV),
  CONSTRAINT fk_LOAICD_KHNGS
  FOREIGN KEY (NGUOISUA)
  REFERENCES NHANVIEN(MANV)
)

Create table TACGIA (
MATG nchar(10) primary key,
TENTG NVARCHAR(500),
NGAYSINH DATE,
DC NVARCHAR(500),
SDT NVARCHAR(10),
EMAIL NVARCHAR(50),
GT NVARCHAR(3),
MOTA NVARCHAR(500),
disabled int DEFAULT '0',
NGUOITAO nvarchar(10),
NGAYTAO Date DEFAULT getdate(),
NGUOISUA nvarchar(10),
NGAYSUA Date DEFAULT getdate(),
CONSTRAINT fk_TG_KHNGT
  FOREIGN KEY (NGUOITAO)
  REFERENCES NHANVIEN(MANV),
  CONSTRAINT fk_TG_KHNGS
  FOREIGN KEY (NGUOISUA)
  REFERENCES NHANVIEN(MANV)
)
Create table NHACC(
MANCC nchar(10) primary key,
TENCC NVARCHAR(500),
DC NVARCHAR(500),
STK NVARCHAR(20),
SDT NVARCHAR(10),
MOTA NVARCHAR(500),
disabled int DEFAULT '0',
NGUOITAO nvarchar(10),
NGAYTAO Date DEFAULT getdate(),
NGUOISUA nvarchar(10),
NGAYSUA Date DEFAULT getdate(),
CONSTRAINT fk_NCC_KHNGT
  FOREIGN KEY (NGUOITAO)
  REFERENCES NHANVIEN(MANV),
  CONSTRAINT fk_NCC_KHNGS
  FOREIGN KEY (NGUOISUA)
  REFERENCES NHANVIEN(MANV)
)
Create table NHAXB(
MANXB nchar(10) primary key,
TENNXB NVARCHAR(500),
DC NVARCHAR(500),
STK NVARCHAR(20),
SDT NVARCHAR(10),
MOTA NVARCHAR(500),
disabled int DEFAULT '0',
NGUOITAO nvarchar(10),
NGAYTAO Date DEFAULT getdate(),
NGUOISUA nvarchar(10),
NGAYSUA Date DEFAULT getdate(),
CONSTRAINT fk_NHAXB_KHNGT
  FOREIGN KEY (NGUOITAO)
  REFERENCES NHANVIEN(MANV),
  CONSTRAINT fk_NXB_KHNGS
  FOREIGN KEY (NGUOISUA)
  REFERENCES NHANVIEN(MANV)
)
Create table SANPHAM(
MASP NCHAR(10) PRIMARY KEY,
TENSP NVARCHAR(500),
NGAYDANG DATE,
GIABAN INT,
GIANHAP INT,
MANCC NCHAR(10),
MANXB NCHAR(10),
XUATXU NVARCHAR(500),
THUONGHIEU NVARCHAR(500),
NGONNGU NVARCHAR(500),
KICHTHUOC NVARCHAR(500),
SOTRANG NVARCHAR(500),
MOTA NVARCHAR(500),
DOTUOI NVARCHAR(500),
HSD DATE,
SLTON INT,
TRONGLUONG INT,
disabled int DEFAULT '0'
CONSTRAINT fk_MANCC_SP
  FOREIGN KEY (MANCC )
  REFERENCES NHACC (MANCC),
CONSTRAINT fk_MANXB_SP
  FOREIGN KEY (MANXB)
  REFERENCES NHAXB (MANXB),
  NGUOITAO nvarchar(10),
NGAYTAO Date DEFAULT getdate(),
NGUOISUA nvarchar(10),
NGAYSUA Date DEFAULT getdate(),
CONSTRAINT fk_SP_KHNGT
  FOREIGN KEY (NGUOITAO)
  REFERENCES NHANVIEN(MANV),
  CONSTRAINT fk_SP_KHNGS
  FOREIGN KEY (NGUOISUA)
  REFERENCES NHANVIEN(MANV)
  )
CREATE table SACHTG(
MASP NCHAR(10),
MATG NCHAR(10),
CONSTRAINT pk_SACHTG
  PRIMARY KEY(MASP,MATG),
  CONSTRAINT fk_SACHTG_SP
  FOREIGN KEY (MASP)
  REFERENCES SANPHAM (MASP),
  CONSTRAINT fk_SACHTG_TG
  FOREIGN KEY (MATG)
  REFERENCES TACGIA (MATG),
  NGUOITAO nvarchar(10),
NGAYTAO Date DEFAULT getdate(),
NGUOISUA nvarchar(10),
NGAYSUA Date DEFAULT getdate(),
CONSTRAINT fk_SCAHTG_KHNGT
  FOREIGN KEY (NGUOITAO)
  REFERENCES NHANVIEN(MANV),
  CONSTRAINT fk_SACHTG_KHNGS
  FOREIGN KEY (NGUOISUA)
  REFERENCES NHANVIEN(MANV)
)
CREATE table SANPHAMHINHANH(
MAHINH int IDENTITY Primary key,
MASP nchar(10),
HINH nvarchar(255),
  CONSTRAINT fk_SANPHAMHINHANH_SP
  FOREIGN KEY (MASP)
  REFERENCES SANPHAM (MASP),
  NGUOITAO nvarchar(10),
NGAYTAO Date DEFAULT getdate(),
NGUOISUA nvarchar(10),
NGAYSUA Date DEFAULT getdate(),
CONSTRAINT fk_SPHINH_KHNGT
  FOREIGN KEY (NGUOITAO)
  REFERENCES NHANVIEN(MANV),
  CONSTRAINT fk_SPHINH_KHNGS
  FOREIGN KEY (NGUOISUA)
  REFERENCES NHANVIEN(MANV)
)
Create table SANPHAMLOAICHUDE(
MASP nchar(10),
MALOAICD nchar(10),
CONSTRAINT pk_SANPHAMLOAICHUDE
  PRIMARY KEY(MASP,MALOAICD),
  CONSTRAINT fk_SANPHAMLOAICHUDE_SP
  FOREIGN KEY (MASP)
  REFERENCES SANPHAM (MASP),
  CONSTRAINT fk_SANPHAMLOAICHUDE_LOAICD
  FOREIGN KEY (MALOAICD)
  REFERENCES LOAICHUDE (MALOAICD),
  NGUOITAO nvarchar(10),
NGAYTAO Date DEFAULT getdate(),
NGUOISUA nvarchar(10),
NGAYSUA Date DEFAULT getdate(),
CONSTRAINT fk_SPCD_KHNGT
  FOREIGN KEY (NGUOITAO)
  REFERENCES NHANVIEN(MANV),
  CONSTRAINT fk_SPCD_KHNGS
  FOREIGN KEY (NGUOISUA)
  REFERENCES NHANVIEN(MANV)
)
Create table KHACHHANG(
MAKH int IDENTITY Primary key,
TENKH nvarchar(255),
DC nvarchar(255),
EMAIL nvarchar(255),
SDT nvarchar(10),
disabled int DEFAULT '0',
MATKHAU nvarchar(255),
)

Create table DANHGIA(
MADG int IDENTITY Primary key,
MASP nchar(10),
MAKH int,
NGAYDANHGIA date DEFAULT getdate(),
DIEMDANHGIA int,
  CONSTRAINT fk_DANHGIA_SP
  FOREIGN KEY (MASP) REFERENCES SANPHAM (MASP),
  CONSTRAINT fk_DANHGIA_KH
  FOREIGN KEY (MAKH) REFERENCES KHACHHANG (MAKH),
)
Create table KHUYENMAI(
MAKHM Nchar(10) primary key,
GIATIEN int,
NGAYBD Date,
NGAYKET Date,
DIEUKIEN int,
HINHTHUCKM int,
NGUOITAO nvarchar(10),
NGAYTAO Date DEFAULT getdate(),
NGUOISUA nvarchar(10),
NGAYSUA Date DEFAULT getdate(),
CONSTRAINT fk_KM_KHNGT
  FOREIGN KEY (NGUOITAO)
  REFERENCES NHANVIEN(MANV),
  CONSTRAINT fk_KM_KHNGS
  FOREIGN KEY (NGUOISUA)
  REFERENCES NHANVIEN(MANV)
)
Create table DONHANG(
MADH int IDENTITY Primary key,
NGAYLAP date DEFAULT getdate(),
TONGTIEN int,
DCGIAO nvarchar(255),
SDT nvarchar(255),
QUOCGIA nvarchar(255),
THANHPHO nvarchar(255),
QUANHUYEN nvarchar(255),
PHUONGXA nvarchar(255),
EMAIL nvarchar(255),
HINHTHUC int,
TRANGTHAI int,
MAKH int DEFAULT NULL,
MAKHM nchar(10),
  CONSTRAINT fk_DONHANG_KH
  FOREIGN KEY (MAKH) REFERENCES KHACHHANG (MAKH),
  CONSTRAINT fk_DONHANG_KM
  FOREIGN KEY (MAKHM) REFERENCES KHUYENMAI (MAKHM),
)
Create table DONHANGCT(
MADH int,
MASP nchar(10),
SL int,
THANHTIEN int,
CONSTRAINT pk_DONHANGCT
  PRIMARY KEY(MADH,MASP),
 CONSTRAINT fk_DONGHANGCT_DONHANG
  FOREIGN KEY (MADH) REFERENCES DONHANG (MADH),
  CONSTRAINT fk_DONHANGCT_SP
  FOREIGN KEY (MASP) REFERENCES SANPHAM (MASP),
)
--ADD admin
INSERT INTO NHANVIEN(MANV,TENNV,MATKHAU) VALUES ('admin','Admin','123')
--Add mặt hàng
INSERT INTO MATHANG(MAMH,TENMATHANG,NGUOITAO) VALUES ('MH001','SACH','admin')
INSERT INTO MATHANG(MAMH,TENMATHANG,NGUOITAO) VALUES ('MH002','ĐỒ CHƠI','admin')
INSERT INTO MATHANG(MAMH,TENMATHANG,NGUOITAO) VALUES ('MH003','DỤNG CỤ','admin')
--
INSERT INTO LOAIMATHANG(MALOAI,TENLOAI,MAMH,NGUOITAO) VALUES ('LMH001','SÁCH TRONG NƯỚC','MH001','admin')
INSERT INTO LOAIMATHANG(MALOAI,TENLOAI,MAMH,NGUOITAO) VALUES ('LMH002','Foreign books','MH001','admin')
INSERT INTO LOAIMATHANG(MALOAI,TENLOAI,MAMH,NGUOITAO) VALUES ('LMH003','Đồ chơi','MH002','admin')
INSERT INTO LOAIMATHANG(MALOAI,TENLOAI,MAMH,NGUOITAO) VALUES ('LMH004','VPP-Dụng cụ học sinh','MH003','admin')

--
INSERT INTO CHUDE(MACD,TENCD,MALOAI,NGUOITAO) VALUES ('CDH001','VĂN HỌC','LMH001','admin')
INSERT INTO CHUDE(MACD,TENCD,MALOAI,NGUOITAO) VALUES ('CDH002','KINH TẾ','LMH001','admin')
INSERT INTO CHUDE(MACD,TENCD,MALOAI,NGUOITAO) VALUES ('CDH003','TÂM LÝ - KỸ NĂNG SỐNG','LMH001','admin')
INSERT INTO CHUDE(MACD,TENCD,MALOAI,NGUOITAO) VALUES ('CDH004','NUÔI DẬY CON','LMH001','admin')
INSERT INTO CHUDE(MACD,TENCD,MALOAI,NGUOITAO) VALUES ('CDH005','SÁCH THIẾU NHI','LMH001','admin')
INSERT INTO CHUDE(MACD,TENCD,MALOAI,NGUOITAO) VALUES ('CDH006','TIỂU SỬ - HỒI KÝ','LMH001','admin')
INSERT INTO CHUDE(MACD,TENCD,MALOAI,NGUOITAO) VALUES ('CDH007','GIÁO KHOA - KHAM KHẢO','LMH001','admin')
INSERT INTO CHUDE(MACD,TENCD,MALOAI,NGUOITAO) VALUES ('CDH008','SÁCH HỌC NGOẠI NGỮ','LMH001','admin')
--
INSERT INTO LOAICHUDE(MALOAICD,TENLOAICD,MACD,NGUOITAO) VALUES ('LCDH001','Tiểu Thuyết','CDH001','admin')
INSERT INTO LOAICHUDE(MALOAICD,TENLOAICD,MACD,NGUOITAO) VALUES ('LCDH001','Truyên ngắn -  Tàn Văn','CDH001','admin')
INSERT INTO LOAICHUDE(MALOAICD,TENLOAICD,MACD,NGUOITAO) VALUES ('LCDH001','Ngôn tình','CDH001','admin')
